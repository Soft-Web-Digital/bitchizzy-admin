import{d as p,f as i,Y as o,b1 as l,b2 as c,aM as h,a0 as n}from"./index.09a9e36e.js";import{u as g}from"./user.7809a3f7.js";const{getAdmin:m}=g(),A=p("roles-permissions",{state:()=>({loading:!1,isAssigning:!1,dialog3:!1,dialog:!1,roles:[],permissions:[],role:{name:"",description:"",permission_id:[]},assign_role_form:{role_id:""}}),getters:{},actions:{async getAllRoles(){const{notify:t}=n(),a=i();this.loading=!0;try{await o.get(l+"?include=permissions,usersCount",{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(e=>{this.roles=e.data.data.roles.data,this.loading=!1})}catch(e){this.loading=!1,t({title:"An Error Occurred",text:e.response.data.message,type:"error"})}},async getAllPermissions(){const{notify:t}=n(),a=i();this.loading=!0;try{await o.get(c+"?do_not_paginate="+1,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(e=>{this.permissions=e.data.data.permissions,this.loading=!1})}catch(e){this.loading=!1,t({title:"An Error Occurred",text:e.response.data.message,type:"error"})}},async createRole(t){const{notify:a}=n(),e=i();this.loading=!0;var s=new FormData;s.append("name",t.name),s.append("description",t.description);for(let r=0;r<t.permission_id.length;r++)s.append("permissions[]",t.permission_id[r]);try{await o.post(l,s,{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(r=>{this.getAllRoles(),this.router.push("/roles"),this.loading=!1})}catch(r){this.loading=!1,a({title:"An Error Occurred",text:r.response.data.message,type:"error"})}},async updateRole(t){const{notify:a}=n(),e=i();this.loading=!0;var s=new FormData;s.append("name",t.name),s.append("description",t.description),s.append("_method","PATCH");for(let r=0;r<this.role.permission_id.length;r++)s.append("permissions[]",this.role.permission_id[r]);try{await o.post(l+"/"+t.id,s,{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(r=>{this.getAllRoles(),this.loading=!1,this.dialog=!1})}catch(r){this.loading=!1,a({title:"An Error Occurred",text:r.response.data.message,type:"error"})}},async deleteRole(t){const{notify:a}=n(),e=i();this.loading=!0;try{await o.delete(l+"/"+t,{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(s=>{this.getAllRoles(),this.loading=!1})}catch(s){this.loading=!1,a({title:"An Error Occurred",text:s.response.data.message,type:"error"})}},async assignRole(t,a){var e=new FormData;e.append("role_id",a.role_id),e.append("_method","PATCH");const{notify:s}=n(),r=i();this.isAssigning=!0;try{await o.post(h+"/"+t+"/role",e,{headers:{Accept:"application/json",Authorization:`Bearer ${r.token}`}}).then(d=>{m(),this.isAssigning=!1,this.dialog3=!1,a={role_id:""},s({title:"Success",text:d.data.message,type:"success"})})}catch(d){this.isAssigning=!1,s({title:"An Error Occurred",text:d.response.data.message,type:"error"})}}}});export{A as u};
