import{a as Ge,s as te,f as Ee,r as p,am as Le,h as qe,A as ze,o as d,c as u,b as l,w as t,a2 as I,af as Me,aB as Ye,a1 as ce,m as _,t as i,a8 as He,I as Oe,D as C,a9 as ae,e as a,u as s,j as R,a6 as N,O as oe,a7 as O,x as v,H as W,aH as We,an as Qe,au as E,ao as Q,ax as Xe,F as L,k as X,aW as Je,ay as Ke,av as Ze,az as el,ai as ll,as as tl,aA as pe,aX as al,T as ol,i as sl,M as nl,N as rl,q as dl,V as ul,p as se,v as ne}from"./index.09a9e36e.js";import{u as _e,_ as fe,a as me,b as he}from"./uploadImage.cddb4d11.js";import{u as ve}from"./giftcard.06a76fe9.js";import{u as ge}from"./withdrawals.6484bb7b.js";import{u as il}from"./index.11c402df.js";import"./filedownloader.f3cc1d55.js";import"./country.9f13e2ad.js";import"./axios-services.17ccf49f.js";const cl=_(" Confirm "),pl=_("Cancel"),_l=_("Yes"),fl={class:"d-flex justify-space-between"},vl=a("h3",null,"Giftcard Transactions",-1),gl=_("Export"),ml=a("div",{class:""},[a("h4",null,"Total Earnings")],-1),hl={key:0,class:"mt-11"},yl={class:"mb-2"},xl=a("span",null,"All time",-1),bl={key:1},Vl={class:"ml-16 d-flex align-center justify-space-between w-100"},kl={class:"d-flex align-start justify-start flex-column w-100"},wl={key:0,class:"pl-3 my-5"},Cl={class:"mb-2"},Tl=a("span",null,"Successful",-1),Al={key:1},Dl={class:"d-flex align-start justify-start flex-column w-100 flex-grow-1"},Fl={key:0,class:"pl-3 my-5"},Ul={class:"mb-2"},jl=a("span",null,"Pending",-1),Il={key:1},Rl={class:"d-flex align-start justify-start flex-column w-100 flex-grow-1"},Nl={key:0,class:"pl-3 my-5"},Sl={class:"mb-2"},$l=a("span",null,"Failed",-1),Pl={key:1},Bl={class:"d-flex align-center justify-space-between w-100"},Gl=a("h4",null,"Filter Options:",-1),El=_("Reset"),Ll=_("Filter"),ql=_("All"),zl=_("Pending"),Ml=_("Approved"),Yl=_("Declined"),Hl=["onClick"],Ol=_(" Approve giftcard "),Wl=_(" Decline giftcard "),Ql={key:1,class:"font-weight-bold text-center my-3"},Xl={class:"mb-3 d-flex justify-space-between"},Jl=a("h3",{class:"text-justify mt-7"},"Partial approval",-1),Kl=a("label",{for:"proof",class:"cursor-pointer"},[a("p",{class:"text-black"},"Upload transaction proof")],-1),Zl={key:0,for:"proof",class:"cursor-pointer"},et=a("img",{src:me,alt:"card-placeholder",class:"mt-3 w-full object-fill max-h-[174px] rounded-xl"},null,-1),lt=[et],tt={class:"gap-5 mt-5",style:{display:"grid","grid-template-columns":"repeat(4, 80px)",gap:"12px"}},at={style:{position:"relative"}},ot=["src"],st=["onClick"],nt={key:1,class:"pt-3 text-center"},rt={class:"p-2 block"},dt={key:2,for:"proof",class:"mt-4 d-flex align-center cursor-pointer"},ut=a("img",{src:he,alt:"plus icon"},null,-1),it=a("p",{class:"ml-3 underline"},"Add more proof",-1),ct=[ut,it],pt=_("submit"),_t=a("h3",null,"Decline Request",-1),ft=a("p",null,"Enter Reasons for Declining this withdrawal request",-1),vt=a("label",{for:"proof",class:"cursor-pointer"},[a("p",{class:"text-black"},"Upload transaction proof")],-1),gt={key:0,for:"proof",class:"cursor-pointer"},mt=a("img",{src:me,alt:"card-placeholder",class:"mt-3 w-full object-fill max-h-[174px] rounded-xl"},null,-1),ht=[mt],yt={class:"gap-5 mt-5",style:{display:"grid","grid-template-columns":"repeat(4, 80px)",gap:"12px"}},xt={style:{position:"relative"}},bt=["src"],Vt=["onClick"],kt={key:1,class:"pt-3 text-center"},wt={class:"p-2 block"},Ct={key:2,for:"proof",class:"mt-4 d-flex align-center cursor-pointer"},Tt=a("img",{src:he,alt:"plus icon"},null,-1),At=a("p",{class:"ml-3 underline"},"Add more proof",-1),Dt=[Tt,At],Ft=_("Submit"),qt=Ge({__name:"transaction",setup(Ut){const{getAllGiftCardTransaction:h,declineRequest:ye,approveRequest:xe,getAllGiftCardTransactionByUserId:jt,partialApproveRequest:be,giftCardTransactionQueries:It,exportGiftcards:Ve}=ve(),{getAllTransactionCount:ke}=ge(),{permissions:we}=te(Ee()),{giftcard_total:T}=te(ge());let B=p(!1),S=p(1),q=p(1);const{gift_transactions:z,loading:J,singleGiftCardTransaction:Rt,declining:Ce,approving:Te,dialog:$,dialog2:P,page:A,tab:K,status:m}=te(ve()),G=r=>new Intl.NumberFormat().format(r),Z=p("");p("");function Ae(){V.value=""}const ee=p([]),De=r=>{B.value=!0;let e=r.length,f=0;if(event){for(q.value=r.length;e--;)_e(r[f]).then(w=>{S.value++,g.value.push(w.secure_url),ee.value.push(w.secure_url)}),f++;S.value=0}},U=Le({review_amount:"",review_note:"",review_proof:[]}),Fe=(r,e)=>{g.value=g.value.filter(f=>f!==r),U.review_proof.splice(e,1)},Ue=(r,e)=>{g.value=g.value.filter(f=>f!==r),ee.value.splice(e,1)},g=p([]),je=r=>{B.value=!0;let e=r.length;console.log(r);let f=0;if(event){for(q.value=r.length;e--;)_e(r[f]).then(w=>{S.value++,g.value.push(w.secure_url),U.review_proof.push(w.secure_url)}),f++;S.value=0}},Ie=p([{title:"No."},{title:"User name"},{title:"Category"},{title:"Reference No."},{title:"Trade Type."},{title:"Amount"},{title:"Date"},{title:"Status"},{title:"Actions"}]);p([{text:"Cards",disabled:!1,href:"#"},{text:"Transactions",disabled:!0,href:"#"}]);const Re=r=>r=="pending"?"yellow-darken-3":r=="approved"?"green lighten-3":r=="declined"?"red lighten-3":r=="partially_approved"?"purple lighten-3":"";p(["Pending","Approved","Declined","Partially_approved"]);const y=p(""),Ne=p(["Buy","Sell"]),x=p(""),b=p(""),V=p(""),Se=r=>r==="partially_approved"?"Partial":r,$e=async()=>{m.value="",y.value="",A.value=1,x.value="",b.value="",await h(m.value,y.value,A.value,x.value,b.value,V.value)};p(null),qe(async()=>{await ke(),await h(m.value,y.value,A.value,x.value,b.value,V.value)});const re=async()=>{await h(m.value,y.value,A.value,x.value,b.value,V.value),g.value=[],B.value=!1},D=p(!1);let k=p("");const M=p(""),le=(r,e)=>{D.value=!0,k.value=e,M.value=r},Pe=async r=>{r=="approve"?(await xe(k.value),re(),D.value=!1):r=="decline"?(ye(k.value,Z.value,ee.value),D.value=!1):r=="partial"&&(be(k.value,U),D.value=!1),D.value=!1};return ze([$,P],([r,e],[f,w])=>{r===!1&&e===!1&&re()}),(r,e)=>{var w;const f=sl("vue-feather");return d(),u(L,null,[l(ae,{modelValue:D.value,"onUpdate:modelValue":e[2]||(e[2]=n=>D.value=n),width:"500"},{default:t(()=>[l(I,null,{default:t(()=>[l(Me,{dark:"",dense:"",flat:""},{default:t(()=>[l(Ye,{class:"text-body-2 font-weight-bold grey--text"},{default:t(()=>[cl]),_:1})]),_:1}),l(ce,{class:"pa-4 black--text"},{default:t(()=>[_("Are you sure you want to "+i(M.value==="partial"?"partially approve":M.value)+" this transaction?",1)]),_:1}),l(He,{class:"pt-3"},{default:t(()=>[l(Oe),l(C,{color:"grey",text:"",class:"body-2 font-weight-bold",onClick:e[0]||(e[0]=n=>D.value=!1)},{default:t(()=>[pl]),_:1}),l(C,{color:"primary",class:"body-2 font-weight-bold",outlined:"",onClick:e[1]||(e[1]=n=>Pe(M.value))},{default:t(()=>[_l]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a("div",fl,[vl,l(C,{onClick:s(Ve),width:"200px",color:"secondary"},{default:t(()=>[gl]),_:1},8,["onClick"])]),((w=s(we))==null?void 0:w.length)==18?(d(),R(O,{key:0,class:"my-3"},{default:t(()=>[l(N,{cols:"12",sm:"6",md:"4"},{default:t(()=>[l(I,{elevation:"0",class:"pa-6 h-100"},{default:t(()=>{var n;return[ml,((n=s(T))==null?void 0:n.length)>0?(d(),u("div",hl,[a("h2",yl," \u20A6\u200E"+i(G(s(T)[0].total_approved_transactions_amount)),1),xl])):(d(),u("p",bl,"loading..."))]}),_:1})]),_:1}),l(N,{cols:"12",sm:"6",md:"8"},{default:t(()=>[l(I,{elevation:"0",class:"py-4 px-2"},{default:t(()=>{var n,c,j;return[a("div",Vl,[a("div",kl,[l(oe,{color:"#e5fafb",size:"x-large"},{default:t(()=>[l(f,{type:"check-circle",class:"text-dark text-success"})]),_:1}),((n=s(T))==null?void 0:n.length)>0?(d(),u("div",wl,[a("h2",Cl,i(G(s(T)[0].total_approved_transactions_count)),1),Tl])):(d(),u("p",Al,"loading..."))]),a("div",Dl,[l(oe,{color:"#FFF9C4",size:"x-large"},{default:t(()=>[l(f,{type:"bar-chart",class:"text-dark text-primary"})]),_:1}),((c=s(T))==null?void 0:c.length)>0?(d(),u("div",Fl,[a("h2",Ul,i(G(s(T)[0].total_pending_transactions_count)),1),jl])):(d(),u("p",Il,"loading..."))]),a("div",Rl,[l(oe,{color:"#FFCCBC",size:"x-large"},{default:t(()=>[l(f,{type:"x-circle",class:"text-dark text-error"})]),_:1}),((j=s(T))==null?void 0:j.length)>0?(d(),u("div",Nl,[a("h2",Sl,i(G(s(T)[0].total_declined_transactions_count)),1),$l])):(d(),u("p",Pl,"loading..."))])])]}),_:1})]),_:1})]),_:1})):v("",!0),l(I,{flat:"",elevation:"0",rounded:"0",class:"my-5 pa-4"},{default:t(()=>[a("div",Bl,[Gl,a("div",null,[l(C,{onClick:$e,width:"200px",class:"mr-4"},{default:t(()=>[El]),_:1}),l(C,{onClick:e[3]||(e[3]=n=>s(h)(s(m),y.value,s(A),x.value,b.value,V.value)),width:"200px",color:"secondary"},{default:t(()=>[Ll]),_:1})])]),l(O,{class:"mt-3"},{default:t(()=>[l(N,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(W,{label:"Filter by Reference",modelValue:V.value,"onUpdate:modelValue":e[4]||(e[4]=n=>V.value=n),density:"compact",variant:"outlined","onClick:clear":Ae,clearable:""},null,8,["modelValue"])]),_:1}),l(N,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(We,{modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=n=>y.value=n),label:"Filter by trade type",density:"compact",items:Ne.value,variant:"outlined"},null,8,["modelValue","items"])]),_:1}),l(N,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(W,{modelValue:x.value,"onUpdate:modelValue":e[6]||(e[6]=n=>x.value=n),label:"Filter date from",density:"compact",type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1}),l(N,{cols:"12",sm:"6",md:"3"},{default:t(()=>[l(W,{modelValue:b.value,"onUpdate:modelValue":e[7]||(e[7]=n=>b.value=n),type:"date",label:"Filter date to",density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(O,null,{default:t(()=>[l(N,{cols:"12",sm:"12",class:"mt-4"},{default:t(()=>{var n;return[l(I,{class:"pa-5"},{default:t(()=>{var c,j;return[l(Qe,{modelValue:s(K),"onUpdate:modelValue":e[12]||(e[12]=F=>E(K)?K.value=F:null),"bg-color":"none",class:"mb-5 border-bottom"},{default:t(()=>[l(Q,{onClick:e[8]||(e[8]=F=>s(h)(m.value=""))},{default:t(()=>[ql]),_:1}),l(Q,{onClick:e[9]||(e[9]=F=>s(h)(m.value="pending"))},{default:t(()=>[zl]),_:1}),l(Q,{onClick:e[10]||(e[10]=F=>s(h)(m.value="approved"))},{default:t(()=>[Ml]),_:1}),l(Q,{onClick:e[11]||(e[11]=F=>s(h)(m.value="declined"))},{default:t(()=>[Yl]),_:1})]),_:1},8,["modelValue"]),l(Xe,null,{default:t(()=>{var F,de;return[a("thead",null,[a("tr",null,[(d(!0),u(L,null,X(Ie.value,(Y,o)=>(d(),u("th",{key:o,class:"text-left"},i(Y.title),1))),128))])]),((de=(F=s(z))==null?void 0:F.data)==null?void 0:de.length)>0&&s(J)==!1?(d(),R(Je,{key:0,name:"list",tag:"tbody"},{default:t(()=>{var Y;return[(d(!0),u(L,null,X((Y=s(z))==null?void 0:Y.data,(o,Be)=>{var ue,ie;return d(),u("tr",{key:o.id},[a("td",null,i(Be+1),1),a("td",{class:"font-weight-bold username",onClick:H=>r.$router.push({name:"UserDetails",params:{id:o==null?void 0:o.user_id}})},i(o.user.firstname)+" "+i(o.user.lastname),9,Hl),a("td",null,i((ie=(ue=o==null?void 0:o.giftcard_product)==null?void 0:ue.giftcard_category)==null?void 0:ie.name),1),a("td",null,i(o.reference),1),a("td",null,i(o.trade_type),1),a("td",null," \u20A6\u200E "+i(G(o.payable_amount*(o.children_count&&o.children_count!==0?o.children_count+1:1))),1),a("td",null,i(s(il)(o==null?void 0:o.created_at,"DD-MM-YYYY hh:mm a").value),1),a("td",null,[l(nl,{label:"",size:"small",class:"text-capitalize font-weight-bold pa-3",color:Re(o==null?void 0:o.status)},{default:t(()=>[_(i(Se((o==null?void 0:o.status)=="partially_approved"?"Approved":o==null?void 0:o.status)),1)]),_:2},1032,["color"])]),a("td",null,[l(O,{justify:"center"},{default:t(()=>[l(rl,{transition:"scroll-y-transition"},{activator:t(({props:H})=>[l(C,dl({text:"",icon:"mdi-dots-vertical",color:"transparent",class:"ma-2"},H),null,16)]),default:t(()=>[l(ul,null,{default:t(()=>[l(se,{to:{name:o.children_count&&o.children_count>0?"RelatedGiftCards":"ViewGiftCardTransaction",params:{id:o.id}},link:"",color:"secondary"},{default:t(()=>[l(ne,null,{default:t(()=>[_(i(o.children_count&&o.children_count>0?"View List":"View giftcard"),1)]),_:2},1024)]),_:2},1032,["to"]),(o==null?void 0:o.status)=="pending"&&(o==null?void 0:o.children_count)==0?(d(),R(se,{key:0,onClick:H=>le("approve",o==null?void 0:o.id),link:"",color:"secondary"},{default:t(()=>[l(ne,null,{default:t(()=>[Ol]),_:1})]),_:2},1032,["onClick"])):v("",!0),(o==null?void 0:o.status)=="pending"&&o.children_count==0?(d(),R(se,{key:1,onClick:H=>(P.value=!0,E(k)?k.value=o==null?void 0:o.id:k=o==null?void 0:o.id),link:"",color:"secondary"},{default:t(()=>[l(ne,null,{default:t(()=>[Wl]),_:1})]),_:2},1032,["onClick"])):v("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])])}),128))]}),_:1})):v("",!0)]}),_:1}),s(J)==!0?(d(),R(Ze,{key:0,class:"align-center justify-center w-100 my-5"},{default:t(()=>[l(Ke,{indeterminate:""})]),_:1})):v("",!0),((j=(c=s(z))==null?void 0:c.data)==null?void 0:j.length)<=0&&s(J)==!1?(d(),u("p",Ql," No data found ")):v("",!0)]}),_:1}),l(el,{modelValue:s(A),"onUpdate:modelValue":[e[13]||(e[13]=c=>E(A)?A.value=c:null),e[16]||(e[16]=(...c)=>s(h)(s(m),y.value,...c,x.value,b.value,V.value))],length:(n=s(z))==null?void 0:n.last_page,onNext:e[14]||(e[14]=(...c)=>s(h)(s(m),y.value,...c,x.value,b.value,V.value)),onPrev:e[15]||(e[15]=(...c)=>s(h)(s(m),y.value,...c,x.value,b.value,V.value)),"active-color":"red",start:1,variant:"flat",class:"mt-5",color:"bg-secondary",rounded:"circle"},null,8,["modelValue","length"])]}),_:1}),s($)?(d(),R(ae,{key:0,modelValue:s($),"onUpdate:modelValue":e[22]||(e[22]=n=>E($)?$.value=n:null),"max-width":"429px","min-height":"476px"},{default:t(()=>[l(I,{class:"view-dialog pa-4"},{default:t(()=>[a("div",Xl,[Jl,l(C,{onClick:e[17]||(e[17]=n=>$.value=!1),icon:"mdi-close",color:"secondary",variant:"text"},{default:t(()=>[l(ll,{icon:"mdi-close"})]),_:1})]),l(tl,{class:"my-10"},{default:t(()=>[l(W,{prefix:"\u20A6\u200E",modelValue:U.review_amount,"onUpdate:modelValue":e[18]||(e[18]=n=>U.review_amount=n),type:"number",variant:"outlined",label:"Review Amount"},null,8,["modelValue"]),l(pe,{modelValue:U.review_note,"onUpdate:modelValue":e[19]||(e[19]=n=>U.review_note=n),variant:"outlined",label:"Review Note"},null,8,["modelValue"]),Kl,g.value.length?v("",!0):(d(),u("label",Zl,lt)),a("input",{type:"file",multiple:"",id:"proof",ref:"fileInput",style:{display:"none"},accept:"image/*",onChange:e[20]||(e[20]=n=>je(n.target.files))},null,544),a("div",tt,[(d(!0),u(L,null,X(g.value,(n,c)=>(d(),u("div",{key:c},[a("div",at,[a("img",{class:"w-full cursor-pointer",style:{height:"75px","object-fit":"cover",width:"100%"},src:n},null,8,ot),a("img",{src:fe,class:"absolute rounded-full border border-red-700 -top-2 -right-2 bg-red-200 text-red-500 cursor-pointer",style:{position:"absolute",right:"-5px",top:"-5px"},width:"20",onClick:j=>Fe(n,c)},null,8,st)])]))),128))]),s(B)?(d(),u("div",nt,[a("small",rt,"Uploaded "+i(s(S))+" of "+i(s(q))+"...",1)])):v("",!0),g.value.length?(d(),u("label",dt,ct)):v("",!0),l(C,{loading:s(Te),onClick:e[21]||(e[21]=n=>le("partial",s(k))),class:"mt-5",block:"",color:"secondary"},{default:t(()=>[pt]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):v("",!0),l(al,null,{default:t(()=>[s(P)?(d(),R(ae,{key:0,modelValue:s(P),"onUpdate:modelValue":e[26]||(e[26]=n=>E(P)?P.value=n:null),"max-width":"500px",width:"100%"},{default:t(()=>[l(I,{"max-width":"500px"},{default:t(()=>[l(ce,null,{default:t(()=>[_t,ft]),_:1}),l(ol,{class:"mt-7"},{default:t(()=>[l(pe,{label:"Comments",modelValue:Z.value,"onUpdate:modelValue":e[23]||(e[23]=n=>Z.value=n),variant:"outlined"},null,8,["modelValue"]),vt,g.value.length?v("",!0):(d(),u("label",gt,ht)),a("input",{type:"file",multiple:"",id:"proof",ref:"fileInput",style:{display:"none"},accept:"image/*",onChange:e[24]||(e[24]=n=>De(n.target.files))},null,544),a("div",yt,[(d(!0),u(L,null,X(g.value,(n,c)=>(d(),u("div",{key:c},[a("div",xt,[a("img",{class:"w-full cursor-pointer",style:{height:"75px","object-fit":"cover",width:"100%"},src:n},null,8,bt),a("img",{src:fe,class:"absolute rounded-full border border-red-700 -top-2 -right-2 bg-red-200 text-red-500 cursor-pointer",style:{position:"absolute",right:"-5px",top:"-5px"},width:"20",onClick:j=>Ue(n,c)},null,8,Vt)])]))),128))]),s(B)?(d(),u("div",kt,[a("small",wt,"Uploaded "+i(s(S))+" of "+i(s(q))+"...",1)])):v("",!0),g.value.length?(d(),u("label",Ct,Dt)):v("",!0),l(C,{color:"secondary",class:"my-5",block:"",loading:s(Ce),onClick:e[25]||(e[25]=n=>le("decline",s(k)))},{default:t(()=>[Ft]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):v("",!0)]),_:1})]),_:1})],64)}}});export{qt as default};
