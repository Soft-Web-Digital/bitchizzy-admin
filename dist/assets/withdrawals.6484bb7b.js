import{d as p,f as n,Y as h,ab as _,ac as l,ad as u,ae as d,a0 as c}from"./index.09a9e36e.js";import{k as r}from"./axios-services.17ccf49f.js";const y=p("withdrawals",{state:()=>({withdrawal:{},payments:{},loading:!1,disapproving:!1,approving:!1,singleWithdrawal:{},dialog:!1,dialog2:!1,transactions:{},all_transaction:{},total_withdrawal:{}}),getters:{withdrawals:s=>s.withdrawal,withdrawals_total:s=>{var a,e;return(e=(a=s.transactions)==null?void 0:a.wallet_transactions)==null?void 0:e.map(t=>({total_completed_transactions_amount:t.total_completed_transactions_amount,total_completed_transactions_count:t.total_completed_transactions_count,total_declined_transactions_count:t.total_declined_transactions_count,total_pending_transactions_count:t.total_pending_transactions_count}))},giftcard_total:s=>{var a,e;return(e=(a=s.transactions)==null?void 0:a.giftcards)==null?void 0:e.map(t=>({total_approved_transactions_amount:t.total_approved_transactions_amount,total_approved_transactions_count:t.total_approved_transactions_count,total_declined_transactions_count:t.total_declined_transactions_count,total_pending_transactions_count:t.total_pending_transactions_count,total_partially_approved_transactions_count:t.total_partially_approved_transactions_count}))},asset_total:s=>{var a,e;return(e=(a=s.transactions)==null?void 0:a.asset_transactions)==null?void 0:e.map(t=>({total_approved_transactions_amount:t.total_approved_transactions_amount,total_approved_transactions_count:t.total_approved_transactions_count,total_declined_transactions_count:t.total_declined_transactions_count,total_pending_transactions_count:t.total_pending_transactions_count,total_partially_approved_transactions_count:t.total_partially_approved_transactions_count}))}},actions:{async getAllTransactionCount(){const s=n();this.loading=!0;try{await h.get(_,{headers:{Accept:"application/json",Authorization:`Bearer ${s.token}`}}).then(a=>{this.loading=!1,this.transactions=a.data.data})}catch{this.loading=!1}},async getAllWithDrawals(s,a){const e=n();this.loading=!0;try{await r.get(l+"?include=user&page="+a+"&filter="+s+"&per_page=100",{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(t=>{this.loading=!1,this.withdrawal=t.data,Array.isArray(t.data.data)?this.total_withdrawal=t.data.data.reduce((o,i)=>o+i.amount,0):console.error("Data is not an array")})}catch{this.loading=!1}},async getAllPayments(s,a){const e=n();this.loading=!0;try{await r.get(u+"?include=user&page="+a+"&filter="+s+"&per_page=100",{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(t=>{this.loading=!1,this.payments=t.data})}catch{this.loading=!1}},async getAllTransactions(s,a){const e=n();this.loading=!0;try{await r.get(d+"?include=user&page="+a+"&filter="+s+"&per_page=100",{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(t=>{this.loading=!1,this.all_transaction=t.data})}catch{this.loading=!1}},async getAllWithDrawalsByUserID(s){const a=n();this.loading=!0;try{await r.get(l+"?include=user&filter[user_id]="+s,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(e=>{this.loading=!1,this.withdrawal=e.data.data.wallet_transactions})}catch{this.loading=!1}},async filterWithDrawalsByDateCreated(s){const a=n(),{notify:e}=c();this.loading=!0;try{await r.get(l+"?sort="+s,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(t=>{this.loading=!1,e({title:"Successful",text:t.data.message,type:"success"}),this.withdrawal=t.data.data.wallet_transactions})}catch{this.loading=!1}},async getSingleWithDrawals(s){const a=n(),{notify:e}=c();try{await r.get(l+"/"+s,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(t=>{this.singleWithdrawal=t.data.data.wallet_transaction})}catch(t){this.loading=!1,e({title:"An Error Occurred",text:t.response.data.message,type:"error"})}},async approveRequest(s){const a=n(),{notify:e}=c();this.loading=!0;var t=new FormData;t.append("_method","POST");try{await r.post(l+"/approve/"+s,t,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(o=>{this.approving=!1,e({title:"Successful",text:o.data.message,type:"success"}),this.getAllWithDrawals("",1),this.dialog=!1})}catch(o){this.approving=!1,this.dialog=!1,e({title:"An Error Occurred",text:o.response.data.message,type:"error"})}},async approveTransactionRequest(s){const a=n(),{notify:e}=c();this.loading=!0;var t=new FormData;t.append("_method","POST");try{await r.post(d+"/approve/"+s,t,{headers:{Accept:"application/json",Authorization:`Bearer ${a.token}`}}).then(o=>{this.approving=!1,e({title:"Successful",text:o.data.message,type:"success"}),this.getAllTransactions("",1),this.dialog=!1})}catch(o){this.approving=!1,this.dialog=!1,e({title:"An Error Occurred",text:o.response.data.message,type:"error"})}},async declineRequest(s,a){const e=n(),{notify:t}=c();this.disapproving=!0;var o=new FormData;o.append("note",a);try{await r.post(l+"/decline/"+s+"?reverse=true",o,{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(i=>{this.disapproving=!1,t({title:"Successful",text:i.data.message,type:"success"}),this.getAllWithDrawals("",1),this.dialog=!1,this.dialog2=!1})}catch(i){this.disapproving=!1,this.dialog=!1,t({title:"An Error Occurred",text:i.response.data.message,type:"error"})}},async declineTransactionRequest(s,a){const e=n(),{notify:t}=c();this.disapproving=!0;var o=new FormData;o.append("note",a);try{await r.post(d+"/decline/"+s,o,{headers:{Accept:"application/json",Authorization:`Bearer ${e.token}`}}).then(i=>{this.disapproving=!1,this.dialog=!1,t({title:"Successful",text:i.data.message,type:"success"}),this.getAllTransactions("",1)})}catch(i){this.disapproving=!1,this.dialog=!1,t({title:"An Error Occurred",text:i.response.data.message,type:"error"})}}}});export{y as u};
