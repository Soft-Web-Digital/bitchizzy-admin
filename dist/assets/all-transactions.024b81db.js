import{u as Ne,_ as Be,a as Le,b as Ee}from"./uploadImage.cddb4d11.js";import{u as ve}from"./asset.ef81bb47.js";import"./user.7809a3f7.js";import{a as Me,s as X,f as Pe,r as p,am as ze,h as Ye,aw as qe,A as Oe,o as u,c as i,b as e,w as l,a2 as I,af as He,aB as We,a1 as fe,m as _,t as c,a8 as Ge,I as Je,D as C,a9 as Z,a6 as A,u as a,j as L,e as s,x as f,O as ee,a7 as Y,H as q,aH as me,au as R,an as Ke,ao as O,ax as Qe,F as H,k as te,ay as Xe,av as Ze,az as et,T as tt,aA as ye,ar as lt,ai as at,as as st,i as ot,M as nt,N as rt,q as dt,V as ut,p as le,v as ae,a3 as it,a4 as ct}from"./index.09a9e36e.js";import{u as ge}from"./withdrawals.6484bb7b.js";import{_ as pt}from"./plugin-vue_export-helper.21dcd24c.js";import{u as _t}from"./index.11c402df.js";import"./axios-services.17ccf49f.js";import"./filedownloader.f3cc1d55.js";import"./country.9f13e2ad.js";const m=E=>(it("data-v-e1a0a1e8"),E=E(),ct(),E),vt=_(" Confirm "),ft=_("Cancel"),mt=_("Yes"),yt=m(()=>s("h2",{class:"my-3"},"Asset transactions",-1)),gt=m(()=>s("div",{class:""},[s("h4",null,"Total Earnings")],-1)),ht={key:0,class:"mt-11"},Vt={class:"mb-2"},bt=m(()=>s("span",null,"All time",-1)),xt={class:"ml-16 d-flex align-center justify-space-between w-100"},wt={class:"d-flex align-start justify-start flex-column w-100"},kt={key:0,class:"pl-3 my-5"},Ct={class:"mb-2"},At=m(()=>s("span",null,"Successful",-1)),Tt={class:"d-flex align-start justify-start flex-column w-100 flex-grow-1"},Ft={key:0,class:"pl-3 my-5"},Dt={class:"mb-2"},St=m(()=>s("span",null,"pending",-1)),It={class:"d-flex align-start justify-start flex-column w-100 flex-grow-1"},Ut={key:0,class:"pl-3 my-5"},$t={class:"mb-2"},Rt=m(()=>s("span",null,"Failed",-1)),jt={class:"d-flex align-center justify-space-between w-100"},Nt=m(()=>s("h4",null,"Filter Options:",-1)),Bt=_("Reset"),Lt=_("Filter"),Et=_("All"),Mt=_("Pending"),Pt=_("Approved"),zt=_("Declined"),Yt={key:0},qt={class:"font-weight-bold"},Ot={key:0},Ht={key:1},Wt=_(" View Details "),Gt=_(" Approve Request "),Jt=_(" Decline Request "),Kt={key:0,class:"font-weight-bold text-center my-3"},Qt=m(()=>s("h3",null,"Decline Transaction",-1)),Xt=m(()=>s("p",null,"Enter Reasons for Declining this asset transaction",-1)),Zt=_("Submit"),el={class:"mb-3 d-flex justify-space-between"},tl=m(()=>s("h3",{class:"text-justify mt-7"},"Partial approval",-1)),ll=m(()=>s("label",{for:"proof",class:"cursor-pointer"},[s("p",{class:"text-black"},"Upload transaction proof")],-1)),al={key:0,for:"proof",class:"cursor-pointer"},sl=m(()=>s("img",{src:Le,alt:"card-placeholder",class:"mt-3 w-full object-fill max-h-[174px] rounded-xl"},null,-1)),ol=[sl],nl={class:"gap-5 mt-5",style:{display:"grid","grid-template-columns":"repeat(4, 80px)",gap:"12px"}},rl={style:{position:"relative"}},dl=["src"],ul=["onClick"],il={key:1,class:"pt-3 text-center"},cl={class:"p-2 block"},pl={key:2,for:"proof",class:"mt-4 d-flex align-center cursor-pointer"},_l=m(()=>s("img",{src:Ee,alt:"plus icon"},null,-1)),vl=m(()=>s("p",{class:"ml-3 underline"},"Add more proof",-1)),fl=[_l,vl],ml=_("submit"),yl=Me({__name:"all-transactions",setup(E){const{getAllTransactionCount:he}=ge(),{asset_total:w}=X(ge()),{permissions:Ve}=X(Pe()),{getAllAssetTransactions:y,approveAssetTransactions:be,declineAssetTransactions:xe,getSingleAssetTransactions:gl,getAllAssetTransactionByTradeType:hl,getAllAssetTransactionsStatus:Vl,getAllAssetTransactionByReference:bl,getAllAssetTransactionByDate:xl,partialApproveRequest:we,getUSDRate:ke}=ve();let se=p(!1),W=p(1),oe=p(1);const T=ze({review_amount:"",review_note:"",review_proof:[]}),U=p([]),Ce=(d,t)=>{U.value=U.value.filter(x=>x!==d),T.review_proof.splice(t,1)},Ae=d=>{se.value=!0;let t=d.length,x=0;if(event){for(oe.value=d.length;t--;)Ne(d[x]).then(n=>{W.value++,U.value.push(n.secure_url),T.review_proof.push(n.secure_url)}),x++;W.value=0}},{allTransactions:M,loading:P,dialog:j,dialog2:$,single_transactions:wl,page:g,tab:G,status:v,usd_rate:ne}=X(ve()),Te=p([{title:"No."},{title:"Full name"},{title:"Reference No."},{title:"Amount"},{title:"Date"},{title:"Trade Type"},{title:"Status"},{title:"Actions"}]),F=p(""),V=p(""),D=p(""),S=p(""),Fe=async()=>{await he(),await y(v.value,g.value,V.value,F.value,D.value,S.value)};let De=p(null);Ye(()=>{Fe(),ke()}),qe(()=>{clearInterval(De.value)});const Se=d=>d=="pending"?"yellow-darken-3":d=="approved"?"green lighten-3":d=="declined"?"red lighten-3":d=="partially_approved"?"purple lighten-3":"",Ie=d=>new Intl.NumberFormat().format(d),re=p("");p("");const Ue=p(""),$e=d=>{Ue.value=d.target.files[0]},Re=async()=>{v.value="",g.value=1,V.value="",F.value="",D.value="",S.value="",await y(v.value,g.value,V.value,F.value,D.value,S.value)},de=async()=>{await y(v.value,g.value,V.value,F.value,D.value,S.value)},k=p(!1);let b=p("");const z=p(""),J=(d,t)=>{k.value=!0,b.value=t,z.value=d},je=async d=>{d=="approve"?(await be(b.value),de(),k.value=!1):d=="decline"?(xe(b.value),k.value=!1):d=="partial"&&(we(b.value,T),k.value=!1),k.value=!1};return Oe([j,$],([d,t],[x,n])=>{d===!1&&t===!1&&de()}),(d,t)=>{const x=ot("vue-feather");return u(),i(H,null,[e(Z,{modelValue:k.value,"onUpdate:modelValue":t[2]||(t[2]=n=>k.value=n),width:"500"},{default:l(()=>[e(I,null,{default:l(()=>[e(He,{dark:"",dense:"",flat:""},{default:l(()=>[e(We,{class:"text-body-2 font-weight-bold grey--text"},{default:l(()=>[vt]),_:1})]),_:1}),e(fe,{class:"pa-4 black--text"},{default:l(()=>[_("Are you sure you want to "+c(z.value==="partial"?"partially approve":z.value)+" this transaction?",1)]),_:1}),e(Ge,{class:"pt-3"},{default:l(()=>[e(Je),e(C,{color:"grey",text:"",class:"body-2 font-weight-bold",onClick:t[0]||(t[0]=n=>k.value=!1)},{default:l(()=>[ft]),_:1}),e(C,{color:"primary",class:"body-2 font-weight-bold",outlined:"",onClick:t[1]||(t[1]=n=>je(z.value))},{default:l(()=>[mt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,null,{default:l(()=>[e(A,{cols:"12",sm:"12",class:"mt-4"},{default:l(()=>{var n,N;return[yt,((n=a(Ve))==null?void 0:n.length)==18?(u(),L(Y,{key:0,class:"my-3"},{default:l(()=>[e(A,{cols:"12",sm:"6",md:"4"},{default:l(()=>[e(I,{elevation:"0",class:"pa-6 h-100"},{default:l(()=>{var r;return[gt,((r=a(w))==null?void 0:r.length)>0?(u(),i("div",ht,[s("h2",Vt," \u20A6\u200E "+c(Ie(a(w)[0].total_approved_transactions_amount)),1),bt])):f("",!0)]}),_:1})]),_:1}),e(A,{cols:"12",sm:"6",md:"8"},{default:l(()=>[e(I,{elevation:"0",class:"py-4 px-2"},{default:l(()=>{var r,B,h;return[s("div",xt,[s("div",wt,[e(ee,{color:"#e5fafb",size:"x-large"},{default:l(()=>[e(x,{type:"check-circle",class:"text-dark text-success"})]),_:1}),((r=a(w))==null?void 0:r.length)>0?(u(),i("div",kt,[s("h2",Ct,c(a(w)[0].total_approved_transactions_count),1),At])):f("",!0)]),s("div",Tt,[e(ee,{color:"#FFF9C4",size:"x-large"},{default:l(()=>[e(x,{type:"bar-chart",class:"text-dark text-primary"})]),_:1}),((B=a(w))==null?void 0:B.length)>0?(u(),i("div",Ft,[s("h2",Dt,c(a(w)[0].total_pending_transactions_count),1),St])):f("",!0)]),s("div",It,[e(ee,{color:"#FFCCBC",size:"x-large"},{default:l(()=>[e(x,{type:"x-circle",class:"text-dark text-error"})]),_:1}),((h=a(w))==null?void 0:h.length)>0?(u(),i("div",Ut,[s("h2",$t,c(a(w)[0].total_declined_transactions_count),1),Rt])):f("",!0)])])]}),_:1})]),_:1})]),_:1})):f("",!0),e(I,{flat:"",rounded:"0",elevation:"0",class:"my-5 pa-4"},{default:l(()=>[s("div",jt,[Nt,s("div",null,[e(C,{onClick:Re,width:"200px",class:"mr-4"},{default:l(()=>[Bt]),_:1}),e(C,{onClick:t[3]||(t[3]=r=>a(y)(a(v),a(g),V.value,F.value,D.value,S.value)),width:"200px",color:"secondary"},{default:l(()=>[Lt]),_:1})])]),e(Y,{class:"mt-3"},{default:l(()=>[e(A,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(q,{label:"Filter by reference",density:"compact",modelValue:F.value,"onUpdate:modelValue":t[4]||(t[4]=r=>F.value=r),variant:"outlined"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",sm:"6",md:"2"},{default:l(()=>[e(me,{label:"Filter by status",density:"compact","persistent-placeholder":!0,placeholder:"Select",modelValue:a(v),"onUpdate:modelValue":t[5]||(t[5]=r=>R(v)?v.value=r:null),items:["Approved","Declined","Transferred","Pending"],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",sm:"6",md:"3"},{default:l(()=>[e(me,{label:"Filter by trade type",density:"compact",placeholder:"Select",modelValue:V.value,"onUpdate:modelValue":t[6]||(t[6]=r=>V.value=r),items:["Buy","Sell"],variant:"outlined"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",sm:"6",md:"2"},{default:l(()=>[e(q,{label:"Filter by date created",density:"compact",modelValue:D.value,"onUpdate:modelValue":t[7]||(t[7]=r=>D.value=r),type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12",sm:"6",md:"2"},{default:l(()=>[e(q,{label:"Filter by date created",density:"compact",modelValue:S.value,"onUpdate:modelValue":t[8]||(t[8]=r=>S.value=r),type:"date",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,{class:"pa-5"},{default:l(()=>{var r,B;return[e(Ke,{modelValue:a(G),"onUpdate:modelValue":t[13]||(t[13]=h=>R(G)?G.value=h:null),"bg-color":"none",class:"mb-5 border-bottom"},{default:l(()=>[e(O,{onClick:t[9]||(t[9]=h=>a(y)(v.value=""))},{default:l(()=>[Et]),_:1}),e(O,{onClick:t[10]||(t[10]=h=>a(y)(v.value="pending"))},{default:l(()=>[Mt]),_:1}),e(O,{onClick:t[11]||(t[11]=h=>a(y)(v.value="approved"))},{default:l(()=>[Pt]),_:1}),e(O,{onClick:t[12]||(t[12]=h=>a(y)(v.value="declined"))},{default:l(()=>[zt]),_:1})]),_:1},8,["modelValue"]),e(Qe,null,{default:l(()=>{var h,ue,ie;return[s("thead",null,[s("tr",null,[(u(!0),i(H,null,te(Te.value,(o,K)=>(u(),i("th",{key:K,class:"text-left"},c(o.title),1))),128))])]),((ue=(h=a(M))==null?void 0:h.data)==null?void 0:ue.length)>0&&a(P)==!1?(u(),i("tbody",Yt,[(u(!0),i(H,null,te((ie=a(M))==null?void 0:ie.data,(o,K)=>{var ce,pe,_e;return u(),i("tr",{key:o.id},[s("td",null,c(K+1),1),s("td",qt,c((pe=(ce=o.user)==null?void 0:ce.firstname)!=null?pe:"No name")+" "+c((_e=o.user)==null?void 0:_e.lastname),1),s("td",null,c(o.reference),1),o.trade_type=="buy"?(u(),i("td",Ot,"\u20A6\u200E"+c((o.payable_amount*a(ne).buy_rate).toLocaleString()),1)):(u(),i("td",Ht,"\u20A6\u200E"+c((o.payable_amount*a(ne).sell_rate).toLocaleString()),1)),s("td",null,c(a(_t)(o==null?void 0:o.created_at,"DD, MMMM-YYYY hh:mm a").value),1),s("td",null,c(o.trade_type),1),s("td",null,[e(nt,{label:"",class:"text-capitalize font-weight-bold pa-3",color:Se(o==null?void 0:o.status)},{default:l(()=>[_(c((o==null?void 0:o.status)=="partially_approved"?"Approved":o==null?void 0:o.status),1)]),_:2},1032,["color"])]),s("td",null,[e(Y,{justify:"center"},{default:l(()=>[e(rt,{transition:"scroll-y-transition"},{activator:l(({props:Q})=>[e(C,dt({text:"",icon:"mdi-dots-vertical",color:"transparent",class:"ma-2"},Q),null,16)]),default:l(()=>[e(ut,null,{default:l(()=>[e(le,{to:{name:"ViewAssetsTransaction",params:{id:o==null?void 0:o.id}},link:"",color:"secondary"},{default:l(()=>[e(ae,null,{default:l(()=>[Wt]),_:1})]),_:2},1032,["to"]),(o==null?void 0:o.status)=="transferred"?(u(),L(le,{key:0,onClick:Q=>J("approve",o==null?void 0:o.id),link:"",color:"secondary"},{default:l(()=>[e(ae,null,{default:l(()=>[Gt]),_:1})]),_:2},1032,["onClick"])):f("",!0),(o==null?void 0:o.status)=="transferred"?(u(),L(le,{key:1,onClick:Q=>($.value=!0,R(b)?b.value=o==null?void 0:o.id:b=o==null?void 0:o.id),link:"",color:"secondary"},{default:l(()=>[e(ae,null,{default:l(()=>[Jt]),_:1})]),_:2},1032,["onClick"])):f("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])])}),128))])):f("",!0)]}),_:1}),((B=(r=a(M))==null?void 0:r.data)==null?void 0:B.length)<=0&&a(P)==!1?(u(),i("p",Kt," No data found ")):f("",!0),a(P)==!0?(u(),L(Ze,{key:1,class:"align-center justify-center w-100 my-5"},{default:l(()=>[e(Xe,{indeterminate:""})]),_:1})):f("",!0)]}),_:1}),e(et,{modelValue:a(g),"onUpdate:modelValue":[t[14]||(t[14]=r=>R(g)?g.value=r:null),t[17]||(t[17]=r=>a(y)(a(v),a(g),V.value))],length:(N=a(M))==null?void 0:N.last_page,onNext:t[15]||(t[15]=r=>a(y)(a(v),a(g),V.value)),onPrev:t[16]||(t[16]=r=>a(y)(a(v),a(g),V.value)),"active-color":"red",start:1,variant:"flat",class:"mt-5",color:"bg-secondary",rounded:"circle"},null,8,["modelValue","length"])]}),_:1}),a($)?(u(),L(Z,{key:0,modelValue:a($),"onUpdate:modelValue":t[20]||(t[20]=n=>R($)?$.value=n:null),"max-width":"500px",width:"100%"},{default:l(()=>[e(I,{"max-width":"500px"},{default:l(()=>[e(fe,null,{default:l(()=>[Qt,Xt]),_:1}),e(tt,{class:"mt-7"},{default:l(()=>[e(ye,{label:"Comments",modelValue:re.value,"onUpdate:modelValue":t[18]||(t[18]=n=>re.value=n),variant:"outlined"},null,8,["modelValue"]),e(lt,{onChange:$e,hint:"Optional","persistent-hint":"",label:"Review proof","append-inner-icon":"mdi-paperclip","prepend-icon":""}),e(C,{color:"secondary",class:"my-5",block:"",loading:d.declining,onClick:t[19]||(t[19]=n=>J("decline",a(b)))},{default:l(()=>[Zt]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):f("",!0),e(Z,{modelValue:a(j),"onUpdate:modelValue":t[26]||(t[26]=n=>R(j)?j.value=n:null),"max-width":"429px","min-height":"476px"},{default:l(()=>[e(I,{class:"view-dialog pa-4"},{default:l(()=>[s("div",el,[tl,e(C,{onClick:t[21]||(t[21]=n=>j.value=!1),icon:"mdi-close",color:"secondary",variant:"text"},{default:l(()=>[e(at,{icon:"mdi-close"})]),_:1})]),e(st,{class:"my-10"},{default:l(()=>[e(q,{prefix:"\u20A6\u200E",modelValue:T.review_amount,"onUpdate:modelValue":t[22]||(t[22]=n=>T.review_amount=n),type:"number",variant:"outlined",label:"Amount"},null,8,["modelValue"]),e(ye,{modelValue:T.review_note,"onUpdate:modelValue":t[23]||(t[23]=n=>T.review_note=n),variant:"outlined",label:"Review Note"},null,8,["modelValue"]),ll,U.value.length?f("",!0):(u(),i("label",al,ol)),s("input",{type:"file",multiple:"",id:"proof",ref:"fileInput",style:{display:"none"},accept:"image/*",onChange:t[24]||(t[24]=n=>Ae(n.target.files))},null,544),s("div",nl,[(u(!0),i(H,null,te(U.value,(n,N)=>(u(),i("div",{key:N},[s("div",rl,[s("img",{class:"w-full cursor-pointer",style:{height:"75px","object-fit":"cover",width:"100%"},src:n},null,8,dl),s("img",{src:Be,class:"absolute rounded-full border border-red-700 -top-2 -right-2 bg-red-200 text-red-500 cursor-pointer",style:{position:"absolute",right:"-5px",top:"-5px"},width:"20",onClick:r=>Ce(n,N)},null,8,ul)])]))),128))]),a(se)?(u(),i("div",il,[s("small",cl,"Uploaded "+c(a(W))+" of "+c(a(oe))+"...",1)])):f("",!0),U.value.length?(u(),i("label",pl,fl)):f("",!0),e(C,{loading:a(P),onClick:t[25]||(t[25]=n=>J("partial",a(b))),block:"",class:"mt-5",color:"secondary"},{default:l(()=>[ml]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}}});var Rl=pt(yl,[["__scopeId","data-v-e1a0a1e8"]]);export{Rl as default};
