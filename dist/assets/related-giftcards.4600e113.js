import{a as Ce,o as i,c as p,b as t,w as o,D as y,e as l,a8 as Z,ax as ke,j as T,av as we,x as c,a9 as X,aX as be,r as v,s as Ve,am as Te,h as Ge,A as De,ai as x,F as P,k as H,t as d,M as ee,m as f,a7 as ae,N as le,q as te,V as oe,p as R,v as L,ay as Ae,as as Ie,H as $e,aA as se,a2 as J,a1 as re,T as Ue,af as Re,aB as Le,I as je,aG as Fe}from"./index.09a9e36e.js";import{u as ne}from"./giftcard.06a76fe9.js";import{u as ie,_ as de,a as ue,b as pe}from"./uploadImage.cddb4d11.js";import{u as Ne}from"./useFormatter.be1a3376.js";import{_ as Se}from"./plugin-vue_export-helper.21dcd24c.js";import{u as Ye}from"./index.11c402df.js";import"./filedownloader.f3cc1d55.js";import"./country.9f13e2ad.js";const qe=Ce({setup(){const e=v([{title:"No."},{title:"User name"},{title:"Category"},{title:"Reference No."},{title:"Trade Type."},{title:"Amount"},{title:"Date"},{title:"Status"},{title:"Actions"}]),s=v("");let j=v(""),C=v(!0);const V=Fe();let F=v(!1),k=v(1),r=v(1);const{loading:h,relatedGiftCards:G,dialog:w,dialog2:D,declining:M,singleGiftCardTransaction:z}=Ve(ne()),{getAllGiftCardTransactionByUserId:N,approveRequest:S,declineRequest:Y,partialApproveRequest:q}=ne(),E=n=>n==="partially_approved"?"Partial":n,a=v(1),u=v([]),A=n=>{F.value=!0;let m=n.length,_=0;if(event){for(r.value=n.length;m--;)ie(n[_]).then(U=>{k.value++,b.value.push(U.secure_url),u.value.push(U.secure_url)}),_++;k.value=0}},g=Te({review_rate:"",review_note:"",review_proof:[]}),I=(n,m)=>{b.value=b.value.filter(_=>_!==n),g.review_proof.splice(m,1)},fe=(n,m)=>{b.value=b.value.filter(_=>_!==n),u.value.splice(m,1)},b=v([]),ce=n=>{F.value=!0;let m=n.length;console.log(n);let _=0;if(event){for(r.value=n.length;m--;)ie(n[_]).then(U=>{k.value++,b.value.push(U.secure_url),g.review_proof.push(U.secure_url)}),_++;k.value=0}},K=()=>{w.value==!0&&(w.value=!1),D.value=!0},ge=()=>{C.value=!1,j.value=V.params.id,W("approve",V.params.id)},ve=()=>{C.value=!1,j.value=V.params.id,K()},me=()=>{C.value=!1,j.value=V.params.id,w.value=!0},he=n=>n=="pending"?"yellow-darken-3":n=="approved"?"green lighten-3":n=="declined"?"red lighten-3":n=="partially_approved"?"green lighten-3":"";Ge(()=>{N(V.params.id)});const{formatCurrency:_e}=Ne(),O=async()=>{await N(V.params.id),b.value=[],F.value=!1},$=v(!1);let B=v("");const Q=v(""),W=(n,m)=>{$.value=!0,B.value=m,Q.value=n},ye=async n=>{n=="approve"?(await S(B.value,1,C.value),O(),$.value=!1):n=="decline"?(Y(B.value,s.value,u.value,C.value),$.value=!1):n=="partial"&&(q(B.value,g,C.value),$.value=!1),$.value=!1,C.value=!0};return De([w,D],([n,m],[_,U])=>{n===!1&&m===!1&&O()}),{related_giftcard:e,relatedGiftCards:G,reproof:u,loading:h,useDateFormat:Ye,formate_text:E,status_color:he,dialog:w,dialog2:D,declining:M,approveRequest:S,declineRequest:Y,partialApproveRequest:q,partial_approve:g,get_reproof:A,note:s,id:j,disapprove:K,approveAll:ge,disapproveAll:ve,partialApproveAll:me,singleGiftCardTransaction:z,page_no:a,partial:ce,formatCurrency:_e,makeConfirmation:ye,openConfirmationDialog:W,previewList:b,startImage:k,totalImage:r,uploadingImage:F,removeImage:I,removeImageDecline:fe,confirmationID:B,confirmationDialog:$,confirmationStatus:Q}}}),Be=f(" Giftcard Transactions "),Me={class:"mb-5 md-mb-0 d-md-flex justify-space-between"},ze=l("h4",{class:"my-5"},"Related Giftcards:",-1),Ee=f(" Approve all "),Pe=f(" Decline all "),He={key:0},Xe=l("td",null,d(1),-1),Je=f(" View giftcard "),Ke=f(" Approve giftcard "),Oe=f(" Decline giftcard "),Qe=["onClick"],We=f(" View giftcard "),Ze=f(" Approve giftcard "),xe=f(" Decline giftcard "),ea={key:1,class:"text-center pa-5"},aa={class:"mb-3 d-flex justify-space-between"},la=l("h3",{class:"text-justify mt-7"},"Partial approval",-1),ta=l("label",{for:"proof",class:"cursor-pointer"},[l("p",{class:"text-black"},"Upload transaction proof")],-1),oa={key:0,for:"proof",class:"cursor-pointer"},sa=l("img",{src:ue,alt:"card-placeholder",class:"mt-3 w-full object-fill max-h-[174px] rounded-xl"},null,-1),ra=[sa],na={class:"gap-5 mt-5",style:{display:"grid","grid-template-columns":"repeat(4, 80px)",gap:"12px"}},ia={style:{position:"relative"}},da=["src"],ua=["onClick"],pa={key:1,class:"pt-3 text-center"},fa={class:"p-2 block"},ca={key:2,for:"proof",class:"mt-4 d-flex align-center cursor-pointer"},ga=l("img",{src:pe,alt:"plus icon"},null,-1),va=l("p",{class:"ml-3 underline"},"Add more proof",-1),ma=[ga,va],ha=f("submit"),_a=l("h3",null,"Decline Request",-1),ya=l("p",null,"Enter Reasons for Declining this withdrawal request",-1),Ca=l("label",{for:"proof",class:"cursor-pointer"},[l("p",{class:"text-black"},"Upload transaction proof")],-1),ka={key:0,for:"proof",class:"cursor-pointer"},wa=l("img",{src:ue,alt:"card-placeholder",class:"mt-3 w-full object-fill max-h-[174px] rounded-xl"},null,-1),ba=[wa],Va={class:"gap-5 mt-5",style:{display:"grid","grid-template-columns":"repeat(4, 80px)",gap:"12px"}},Ta={style:{position:"relative"}},Ga=["src"],Da=["onClick"],Aa={key:1,class:"pt-3 text-center"},Ia={class:"p-2 block"},$a={key:2,for:"proof",class:"mt-4 d-flex align-center cursor-pointer"},Ua=l("img",{src:pe,alt:"plus icon"},null,-1),Ra=l("p",{class:"ml-3 underline"},"Add more proof",-1),La=[Ua,Ra],ja=f("Submit"),Fa=f(" Confirm "),Na=f("Cancel"),Sa=f("Yes");function Ya(e,s,j,C,V,F){var k;return i(),p("div",null,[t(y,{link:"",size:"small",color:"grey-darken-4",to:{name:"GiftCardTransaction"}},{default:o(()=>[t(x,{size:"small",start:"",icon:"mdi-arrow-left"}),Be]),_:1}),l("div",Me,[ze,t(Z,{class:"d-flex flex-wrap align-start",style:{gap:"10px",padding:"0% !important"}},{default:o(()=>[t(y,{class:"mr-2 md-mr-4",color:"green lighten-3",loading:e.approving,variant:"tonal",onClick:s[0]||(s[0]=r=>e.approveAll())},{default:o(()=>[Ee]),_:1},8,["loading"]),t(y,{color:"red lighten-3",variant:"tonal",onClick:s[1]||(s[1]=r=>e.disapproveAll())},{default:o(()=>[Pe]),_:1})]),_:1})]),t(ke,null,{default:o(()=>{var r,h,G,w,D,M,z,N,S,Y,q,E;return[l("thead",null,[l("tr",null,[(i(!0),p(P,null,H(e.related_giftcard,(a,u)=>(i(),p("th",{key:u,class:"text-left"},d(a.title),1))),128))])]),((r=e.relatedGiftCards)==null?void 0:r.length)>0&&e.loading==!1?(i(),p("tbody",He,[l("tr",null,[Xe,l("td",{class:"font-weight-bold username",onClick:s[2]||(s[2]=a=>{var u;return e.$router.push({name:"UserDetails",params:{id:(u=e.singleGiftCardTransaction)==null?void 0:u.user_id}})})},d((G=(h=e.singleGiftCardTransaction)==null?void 0:h.user)==null?void 0:G.firstname)+" "+d((D=(w=e.singleGiftCardTransaction)==null?void 0:w.user)==null?void 0:D.lastname),1),l("td",null,d((N=(z=(M=e.singleGiftCardTransaction)==null?void 0:M.giftcard_product)==null?void 0:z.giftcard_category)==null?void 0:N.name),1),l("td",null,d((S=e.singleGiftCardTransaction)==null?void 0:S.reference),1),l("td",null,d((Y=e.singleGiftCardTransaction)==null?void 0:Y.trade_type),1),l("td",null,d(e.formatCurrency(e.singleGiftCardTransaction.payable_amount*(e.singleGiftCardTransaction.children_count&&e.singleGiftCardTransaction.children_count!==0?e.singleGiftCardTransaction.children_count+1:1))),1),l("td",null,d(e.useDateFormat((q=e.singleGiftCardTransaction)==null?void 0:q.created_at,"DD-MM-YYYY hh:mm a").value),1),l("td",null,[t(ee,{label:"",size:"small",class:"text-capitalize font-weight-bold pa-3",color:e.status_color((E=e.singleGiftCardTransaction)==null?void 0:E.status)},{default:o(()=>{var a,u;return[f(d(((a=e.singleGiftCardTransaction)==null?void 0:a.status)=="partially_approved"?"Approved":(u=e.singleGiftCardTransaction)==null?void 0:u.status),1)]}),_:1},8,["color"])]),l("td",null,[t(ae,{justify:"center"},{default:o(()=>[t(le,{transition:"scroll-y-transition"},{activator:o(({props:a})=>[t(y,te({text:"",icon:"mdi-dots-vertical",color:"transparent",class:"ma-2"},a),null,16)]),default:o(()=>[t(oe,null,{default:o(()=>{var a,u;return[t(R,{to:{name:"ViewGiftCardTransaction",params:{id:e.singleGiftCardTransaction.id}},link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[Je]),_:1})]),_:1},8,["to"]),((a=e.singleGiftCardTransaction)==null?void 0:a.status)=="pending"?(i(),T(R,{key:0,onClick:s[3]||(s[3]=A=>{var g;return e.approveRequest((g=e.singleGiftCardTransaction)==null?void 0:g.id,e.page_no)}),link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[Ke]),_:1})]),_:1})):c("",!0),((u=e.singleGiftCardTransaction)==null?void 0:u.status)=="pending"?(i(),T(R,{key:1,onClick:s[4]||(s[4]=A=>{var g;e.id=(g=e.singleGiftCardTransaction)==null?void 0:g.id,e.disapprove()}),link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[Oe]),_:1})]),_:1})):c("",!0)]}),_:1})]),_:1})]),_:1})])]),(i(!0),p(P,null,H(e.relatedGiftCards,(a,u)=>{var A,g;return i(),p("tr",{class:"pa-2",key:a.id},[l("td",null,d(u+2),1),l("td",{class:"font-weight-bold username",onClick:I=>e.$router.push({name:"UserDetails",params:{id:a==null?void 0:a.user_id}})},d(a.user.firstname)+" "+d(a.user.lastname),9,Qe),l("td",null,d((g=(A=a==null?void 0:a.giftcard_product)==null?void 0:A.giftcard_category)==null?void 0:g.name),1),l("td",null,d(a.reference),1),l("td",null,d(a.trade_type),1),l("td",null,d(e.formatCurrency(a.payable_amount*(a.children_count&&a.children_count!==0?a.children_count+1:1))),1),l("td",null,d(e.useDateFormat(a==null?void 0:a.created_at,"DD-MM-YYYY hh:mm a").value),1),l("td",null,[t(ee,{label:"",size:"small",class:"text-capitalize font-weight-bold pa-3",color:e.status_color(a==null?void 0:a.status)},{default:o(()=>[f(d(e.formate_text((a==null?void 0:a.status)=="partially_approved"?"Approved":a==null?void 0:a.status)),1)]),_:2},1032,["color"])]),l("td",null,[t(ae,{justify:"center"},{default:o(()=>[t(le,{transition:"scroll-y-transition"},{activator:o(({props:I})=>[t(y,te({text:"",icon:"mdi-dots-vertical",color:"transparent",class:"ma-2"},I),null,16)]),default:o(()=>[t(oe,null,{default:o(()=>[t(R,{to:{name:"ViewGiftCardTransaction",params:{id:a.id}},link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[We]),_:1})]),_:2},1032,["to"]),(a==null?void 0:a.status)=="pending"?(i(),T(R,{key:0,onClick:I=>e.openConfirmationDialog("approve",a==null?void 0:a.id),link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[Ze]),_:1})]),_:2},1032,["onClick"])):c("",!0),(a==null?void 0:a.status)=="pending"?(i(),T(R,{key:1,onClick:I=>(e.dialog2=!0,e.id=a==null?void 0:a.id),link:"",color:"secondary"},{default:o(()=>[t(L,null,{default:o(()=>[xe]),_:1})]),_:2},1032,["onClick"])):c("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)])])}),128))])):c("",!0)]}),_:1}),e.loading==!0?(i(),T(we,{key:0,class:"align-center justify-center w-100 my-5"},{default:o(()=>[t(Ae,{indeterminate:""})]),_:1})):c("",!0),((k=e.relatedGiftCards)==null?void 0:k.length)<=0||e.relatedGiftCards==null?(i(),p("p",ea," No related giftcard ")):c("",!0),e.dialog?(i(),T(X,{key:2,modelValue:e.dialog,"onUpdate:modelValue":s[10]||(s[10]=r=>e.dialog=r),"max-width":"429px","min-height":"476px"},{default:o(()=>[t(J,{class:"view-dialog pa-4"},{default:o(()=>[l("div",aa,[la,t(y,{onClick:s[5]||(s[5]=r=>e.dialog=!1),icon:"mdi-close",color:"secondary",variant:"text"},{default:o(()=>[t(x,{icon:"mdi-close"})]),_:1})]),t(Ie,{class:"my-10"},{default:o(()=>[t($e,{prefix:"\u20A6\u200E",modelValue:e.partial_approve.review_rate,"onUpdate:modelValue":s[6]||(s[6]=r=>e.partial_approve.review_rate=r),type:"number",variant:"outlined",label:"Review Amount"},null,8,["modelValue"]),t(se,{modelValue:e.partial_approve.review_note,"onUpdate:modelValue":s[7]||(s[7]=r=>e.partial_approve.review_note=r),variant:"outlined",label:"Review Note"},null,8,["modelValue"]),ta,e.previewList.length?c("",!0):(i(),p("label",oa,ra)),l("input",{type:"file",multiple:"",id:"proof",ref:"fileInput",style:{display:"none"},accept:"image/*",onChange:s[8]||(s[8]=r=>e.partial(r.target.files))},null,544),l("div",na,[(i(!0),p(P,null,H(e.previewList,(r,h)=>(i(),p("div",{key:h},[l("div",ia,[l("img",{class:"w-full cursor-pointer",style:{height:"75px","object-fit":"cover",width:"100%"},src:r},null,8,da),l("img",{src:de,class:"absolute rounded-full border border-red-700 -top-2 -right-2 bg-red-200 text-red-500 cursor-pointer",style:{position:"absolute",right:"-5px",top:"-5px"},width:"20",onClick:G=>e.removeImage(r,h)},null,8,ua)])]))),128))]),e.uploadingImage?(i(),p("div",pa,[l("small",fa,"Uploaded "+d(e.startImage)+" of "+d(e.totalImage)+"...",1)])):c("",!0),e.previewList.length?(i(),p("label",ca,ma)):c("",!0),t(y,{loading:e.approving,onClick:s[9]||(s[9]=r=>e.openConfirmationDialog("partial",e.id)),class:"mt-5",block:"",color:"secondary"},{default:o(()=>[ha]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0),t(be,null,{default:o(()=>[e.dialog2?(i(),T(X,{key:0,modelValue:e.dialog2,"onUpdate:modelValue":s[14]||(s[14]=r=>e.dialog2=r),"max-width":"500px",width:"100%"},{default:o(()=>[t(J,{"max-width":"500px"},{default:o(()=>[t(re,null,{default:o(()=>[_a,ya]),_:1}),t(Ue,{class:"mt-7"},{default:o(()=>[t(se,{label:"Comments",modelValue:e.note,"onUpdate:modelValue":s[11]||(s[11]=r=>e.note=r),variant:"outlined"},null,8,["modelValue"]),Ca,e.previewList.length?c("",!0):(i(),p("label",ka,ba)),l("input",{type:"file",multiple:"",id:"proof",ref:"fileInput",style:{display:"none"},accept:"image/*",onChange:s[12]||(s[12]=r=>e.get_reproof(r.target.files))},null,544),l("div",Va,[(i(!0),p(P,null,H(e.previewList,(r,h)=>(i(),p("div",{key:h},[l("div",Ta,[l("img",{class:"w-full cursor-pointer",style:{height:"75px","object-fit":"cover",width:"100%"},src:r},null,8,Ga),l("img",{src:de,class:"absolute rounded-full border border-red-700 -top-2 -right-2 bg-red-200 text-red-500 cursor-pointer",style:{position:"absolute",right:"-5px",top:"-5px"},width:"20",onClick:G=>e.removeImageDecline(r,h)},null,8,Da)])]))),128))]),e.uploadingImage?(i(),p("div",Aa,[l("small",Ia,"Uploaded "+d(e.startImage)+" of "+d(e.totalImage)+"...",1)])):c("",!0),e.previewList.length?(i(),p("label",$a,La)):c("",!0),t(y,{color:"secondary",class:"my-5",block:"",loading:e.declining,onClick:s[13]||(s[13]=r=>e.openConfirmationDialog("decline",e.id))},{default:o(()=>[ja]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])):c("",!0)]),_:1}),t(X,{modelValue:e.confirmationDialog,"onUpdate:modelValue":s[17]||(s[17]=r=>e.confirmationDialog=r),width:"500"},{default:o(()=>[t(J,null,{default:o(()=>[t(Re,{dark:"",dense:"",flat:""},{default:o(()=>[t(Le,{class:"text-body-2 font-weight-bold grey--text"},{default:o(()=>[Fa]),_:1})]),_:1}),t(re,{class:"pa-4 black--text"},{default:o(()=>[f("Are you sure you want to "+d(e.confirmationStatus==="partial"?"partially approve":e.confirmationStatus)+" this transaction?",1)]),_:1}),t(Z,{class:"pt-3"},{default:o(()=>[t(je),t(y,{color:"grey",text:"",class:"body-2 font-weight-bold",onClick:s[15]||(s[15]=r=>e.confirmationDialog=!1)},{default:o(()=>[Na]),_:1}),t(y,{color:"primary",class:"body-2 font-weight-bold",outlined:"",onClick:s[16]||(s[16]=r=>e.makeConfirmation(e.confirmationStatus))},{default:o(()=>[Sa]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var Ja=Se(qe,[["render",Ya]]);export{Ja as default};
