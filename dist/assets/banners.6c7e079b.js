import{d as ue,f,Y as _,a as de,a$ as pe,aW as P,r as p,b0 as $,o as m,c as v,e as a,b as t,w as n,D,at as me,F as ge,k as fe,u as r,x as z,j as _e,au as ve,ar as he,a2 as Q,av as ye,ao as be,an as Y,a9 as we,m as g,t as h,P as E,M as ke,a7 as Be,N as Ve,q as Ae,V as Ce,p as F,v as j,a0 as xe}from"./index.768fb5ed.js";import{N as Se}from"./vue-easy-lightbox.esm.min.d54ae765.js";/* empty css                          */import{u as $e}from"./index.bb23e1de.js";const De=ue("banners",{actions:{async getAllBanners(){const i=f();return await _.get("/admin/banners?include=admin",{headers:{Accept:"application/json",Authorization:`Bearer ${i.token}`}})},async deleteBanners(i){const l=f();return await _.delete(`/admin/banners/${i}`,{headers:{Accept:"application/json",Authorization:`Bearer ${l.token}`}})},async getSingleBanner(i){const l=f();return await _.get(`/admin/banners/${i}`,{headers:{Accept:"application/json",Authorization:`Bearer ${l.token}`}})},async toggleBannerActivation(i){const l=f();return await _.patch(`/admin/banners/${i}/activation`,"",{headers:{Accept:"application/json",Authorization:`Bearer ${l.token}`}})},async uploadBanners(i){const l=f();var c=new FormData;return c.append("preview_image",i.preview_image,"image.webp"),c.append("featured_image",i.featured_image,"intro-to-cloud.jpeg"),await _.post("/admin/banners?include=admin",c,{headers:{Accept:"application/json",Authorization:`Bearer ${l.token}`}})}}}),Fe={class:"d-flex align-center justify-space-between"},je=a("h2",null,"Banners",-1),Ne=g("Create banners"),Te=a("thead",null,[a("tr",null,[a("th",null,"No"),a("th",null,"Admin"),a("th",null,"Preview image"),a("th",null,"Featured image"),a("th",null,"Created at"),a("th",null,"Status"),a("th",null,"Action")])],-1),Le=g(" View Banner "),Me=g(" Toggle Banner Activation "),Pe=g(" Delete Banner "),ze={key:0,class:"py-7 text-center font-weight-bold"},Qe={key:2},Ye=a("h3",null,"Select banners for upload",-1),Ee=g("Submit"),Oe=de({__name:"banners",setup(i){const{notify:l}=xe(),c=pe(),{getAllBanners:N,getSingleBanner:I,uploadBanners:R,deleteBanners:q,toggleBannerActivation:W}=De(),{data:B,isLoading:T,isError:H,isFetching:L,refetch:Ie}=P("get-banners",N,{refetchOnWindowFocus:!1,staleTime:1e5,retry:4,select:e=>{var o,u,d;return(d=(u=(o=e.data)==null?void 0:o.data)==null?void 0:u.banners)==null?void 0:d.data}}),V=p("");p([]),p(!1);const A=p(!1),O=()=>{A.value=!0},U=p(0),G=()=>A.value=!1,{data:J,refetch:K}=P(["single-banner",V.value],()=>I(V.value),{enabled:!1,staleTime:1e5,retry:4,onSuccess:e=>{O()},onError:e=>{console.log(B)},select(e){var o,u,d,b,w;let s=[];return s.push((d=(u=(o=e==null?void 0:e.data)==null?void 0:o.data)==null?void 0:u.banner)==null?void 0:d.featured_image,(w=(b=e==null?void 0:e.data.data)==null?void 0:b.banner)==null?void 0:w.preview_image),s}}),y=p(!1),C=p(null),x=p(null),{isLoading:M,mutate:X}=$(e=>R(e),{onSuccess:()=>{y.value=!1,C.value=null,x.value=null,c.invalidateQueries("get-banners")},onError:e=>{M.value=!1,l({type:"error",title:"Success",text:e==null?void 0:e.message})}}),Z=async e=>{await X(e)},{mutate:ee}=$(e=>W(e),{onSuccess(e){l({type:"success",title:"Success",text:e==null?void 0:e.message}),c.invalidateQueries("get-banners")}}),te=async(e,s)=>{confirm(`Are you sure you want to ${s==!1?"Activate":"Deactivate"} this banner?`)&&await ee(e)},{mutate:ae}=$(e=>q(e),{onSuccess(e){var s;l({type:"success",title:"Success",text:(s=e==null?void 0:e.data)==null?void 0:s.message}),c.invalidateQueries("get-banners")}}),ne=async e=>{confirm("Are you sure you want to delete this banner?")&&await ae(e)},se=e=>{C.value=e.target.files[0]},le=e=>{x.value=e.target.files[0]},oe=e=>e!==null?"Activated":"Not active",re=e=>e!==null?"green lighten-3":"black lighten-3";return(e,s)=>(m(),v("div",null,[a("div",Fe,[je,t(D,{onClick:s[0]||(s[0]=o=>y.value=!0),color:"secondary"},{default:n(()=>[Ne]),_:1})]),t(Q,{class:"mt-6"},{default:n(()=>{var o;return[t(me,null,{default:n(()=>[Te,a("tbody",null,[(m(!0),v(ge,null,fe(r(B),({id:u,admin:d,featured_image:b,preview_image:w,created_at:ie,activated_at:S},ce)=>(m(),v("tr",{key:u},[a("td",null,h(ce+1),1),a("td",null,h(d.firstname)+" "+h(d.lastname),1),a("td",null,[t(E,{width:"40px",src:b},null,8,["src"])]),a("td",null,[t(E,{width:"40px",src:w},null,8,["src"])]),a("td",null,h(r($e)(ie,"DD, MMM YYYY - hh:mm a").value),1),a("td",null,[t(ke,{color:re(S)},{default:n(()=>[g(h(oe(S)),1)]),_:2},1032,["color"])]),a("td",null,[t(Be,null,{default:n(()=>[t(Ve,{transition:"scroll-y-transition"},{activator:n(({props:k})=>[t(D,Ae({text:"",icon:"mdi-dots-vertical",color:"transparent"},k),null,16)]),default:n(()=>[t(Ce,null,{default:n(()=>[t(F,{onClick:k=>r(K)(V.value=u),link:"",color:"secondary"},{default:n(()=>[t(j,null,{default:n(()=>[Le]),_:1})]),_:2},1032,["onClick"]),t(F,{onClick:k=>te(u,S!==null),link:"",color:"secondary"},{default:n(()=>[t(j,null,{default:n(()=>[Me]),_:1})]),_:2},1032,["onClick"]),t(F,{onClick:k=>ne(u),link:"",color:"secondary"},{default:n(()=>[t(j,null,{default:n(()=>[Pe]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)])]))),128))])]),_:1}),((o=r(B))==null?void 0:o.length)<=0&&r(T)==!1&&r(L)==!1?(m(),v("p",ze," No data available ")):z("",!0),r(T)==!0&&r(L)==!0?(m(),_e(he,{key:1,class:"align-center justify-center w-100 my-5"},{default:n(()=>[t(ve,{indeterminate:""})]),_:1})):r(H)?(m(),v("p",Qe,"An error occurred")):z("",!0)]}),_:1}),t(ye,{class:"my-7",variant:"flat",color:"secondary",rounded:"circle"}),t(we,{modelValue:y.value,"onUpdate:modelValue":s[2]||(s[2]=o=>y.value=o),"max-width":"500px"},{default:n(()=>[t(Q,{class:"pa-4"},{default:n(()=>[Ye,t(be,{class:"mt-8 py-8"},{default:n(()=>[t(Y,{onChange:se,label:"Preview image",variant:"outlined","prepend-icon":"","append-inner-icon":"mdi-paperclip"}),t(Y,{onChange:le,label:"Featured image",variant:"outlined","prepend-icon":"","append-inner-icon":"mdi-paperclip"}),t(D,{loading:r(M),onClick:s[1]||(s[1]=o=>Z({preview_image:C.value,featured_image:x.value})),color:"secondary",block:""},{default:n(()=>[Ee]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(r(Se),{visible:A.value,imgs:r(J),index:U.value,onHide:G},null,8,["visible","imgs","index"])]))}});export{Oe as default};
